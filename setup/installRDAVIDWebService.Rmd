---
title: "RDAVIDWebService Install"
output: html_document
---

# macOS environment

* [Homebrew](http://brew.sh)
* [RStudio](https://www.rstudio.com)
* [Java JDK 1.8](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html)

## openssl update

In terminal:

```{bash openssl, eval = FALSE}
brew update
brew install openssl
brew link --force openssl

# Quit terminal and relaunch
openssl version
```


## Java JDK 1.8 update

The current version of the web service only works with JDK 1.8, which must be
installed from Oracle. The Mac Java JDK is version 1.6.

* [Bioconductor thread #72188](https://support.bioconductor.org/p/72188/)
* [Stack Overflow thread #31480579](http://stackoverflow.com/questions/31480579/r-david-webservice-sudden-transport-error-301-error-moved-permanently)


## DAVID certificates

In terminal:

```{bash, eval = FALSE}
echo -n | openssl s_client -connect david.ncifcrf.gov:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' > ncifcrf.cert

# Check if it was properly downloaded:
openssl x509 -in ncifcrf.cert -text

# Update cacerts in JRE:
sudo cp /Library/Java/JavaVirtualMachines/jdk1.8.0_92.jdk/Contents/Home/jre/lib/security/cacerts .
sudo keytool -import -trustcacerts -keystore cacerts -storepass changeit -noprompt -alias david -file ncifcrf.cert
sudo cp cacerts /Library/Java/JavaVirtualMachines/jdk1.8.0_92.jdk/Contents/Home/jre/lib/security/cacerts
```


## Reconfigure Java in R

In terminal:

```{bash eval = FALSE}
sudo R CMD javareconf
```

## Update rJava from source

See [Bioconductor thread #70090](https://support.bioconductor.org/p/70090/)
for more info.

```{r rjava, eval = FALSE}
install.packages('rJava',,'http://www.rforge.net/')
```

### Check if rJava loads

```{r rstudio check}
dyn.load("/Library/Java/JavaVirtualMachines/jdk1.8.0_92.jdk/Contents/Home/jre/lib/server/libjvm.dylib")
library("rJava")
.jinit()
.jcall("java/lang/System", "S", "getProperty", "java.runtime.version")
```


## Install RDAVIDWebService

```{r RDAVIDWebService, eval = FALSE}
source("https://bioconductor.org/biocLite.R")
biocLite("RDAVIDWebService")
browseVignettes("RDAVIDWebService")
```
